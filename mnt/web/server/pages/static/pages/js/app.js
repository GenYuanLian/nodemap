!function t(e,n,o){function i(u,a){if(!n[u]){if(!e[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(r)return r(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[u]={exports:{}};e[u][0].call(l.exports,function(t){var n=e[u][1][t];return i(n||t)},l,l.exports,t,e,n,o)}return n[u].exports}for(var r="function"==typeof require&&require,u=0;u<o.length;u++)i(o[u]);return i}({1:[function(t,e,n){$("body").on("touchstart",function(){}),new Vue({el:"#nodemap",data:{map:null,sizes:[{minimumCount:10,symbolSize:23},{minimumCount:5,symbolSize:18},{minimumCount:3,symbolSize:13},{minimumCount:1,symbolSize:8}]},methods:{updateMap:function(t,e){var n,o=this,i=this.sizes.length,r=new Array(i),u={},a=0;t.forEach(function(t,e){for(node=[t.longitude,t.latitude,t.count,t.city,t.province,t.country],n=0;n<i;n++)if(t.count>=o.sizes[n].minimumCount){r[n]||(r[n]=[]),r[n].push(node);break}u[t.country]?u[t.country].count+=t.count:u[t.country]=t,a+=t.count}),u=Object.values(u).sort(function(t,e){return e.count-t.count});var c=this.sizes.map(function(t,e){return{type:"effectScatter",coordinateSystem:"geo",data:r[e],symbolSize:t.symbolSize,showEffectOn:"render",rippleEffect:{scale:3,brushType:"stroke"},label:{normal:{show:!1},emphasis:{show:!1}},itemStyle:{normal:{color:"#ff8c3a"}}}});if(e.setOption({tooltip:{formatter:function(t){var e=t.data,n={country:e[5],province:e[4],city:e[3],count:e[2]};return[interpolate(gettext("%(country)s %(province)s %(city)s"),n,!0).split(" ").filter(function(t){return""!==t}).join(gettext("，")),interpolate(gettext("数量：%(count)s"),n,!0)].join("<br>")}},geo:{map:"world",left:0,right:0,silent:!0,roam:!0,itemStyle:{normal:{borderColor:"#ccc",color:"#4b73b0"}}},series:c}),a>0){var s=$($("#nodeinfo--template").html());s.find(".nodeinfo--count").text(a),$(".nodeinfo").html(s)}},updateNodes:function(){var t=this;$.ajax({url:"/api/nodes",dataType:"json",success:function(e){t.updateMap(e,t.map)},complete:function(){setTimeout(t.updateNodes,3e4)}})}},mounted:function(){this.$nextTick(function(){this.map=echarts.init($("#nodemap").get(0)),this.updateNodes()})}}),new Vue({el:"#select-language",data:{},methods:{languageChange:function(){$("#select-language").submit()}}})},{}]},{},[1]);